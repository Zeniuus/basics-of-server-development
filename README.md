# Basics of Server Development

## 개요

이 레포지토리는 내가 시니어의 직접적인 케어 없이 홀로 개발을 할 수 있게 되는 데에 가장 중요했던 요소를 모아놓은 저장소이다. 굳이 "요소"라는 애매한 워딩을 사용한 이유는 이 문서에 작성된 글이 다양한 분야의 다양한 주제를 다루기 때문이다. 각 문서의 주제는 개발할 때의 원칙/태도일 수도, 개발 전략일 수도, 혹은 특정 지식일 수도 있다. 이는 개발자로서 1인분을 하기 위해서는 특정 분야에 치우치지 않고 다방면으로 학습하는 게 중요하다는 반증이기도 하다.

이 문서는 레이 달리오의 \<Principles\>를 읽은 것이 계기가 되어 작성하게 되었다. 많은 생각을 하게 만들어준 책이었는데, 그 중 하나는 개발을 함에 있어서도 일반적으로 지켜야 하는 원칙이 꽤 많다는 점이었다. 레이 달리오가 인생과 투자의 원칙을 세운 것처럼, 나도 개발의 원칙을 세워 나보다 내가 세운 원칙을 기준으로 개발을 하고, 이런 원칙들을 다른 사람들과 공유하면 좋겠다는 생각이 들었다.

## 서버 개발자로서 1인분을 하기 위해 필요한 것

서버 개발자로서 1인분을 하기 위해서는 서버 개발자의 역할을 정의하는 게 중요할 것이다. 서버 개발자의 역할은 크게 두 가지 관점으로 정의할 수 있을 것 같다.

### 개발팀 내에서

내가 1~2년차를 보냈던 VCNC에서는 서버팀이 담당하는 작업의 범위가 매우 넓어서 "이걸 다 서버팀이 하는 게 맞아?"라는 생각이 들었었다. 그런데 몇몇 회사 이야기를 들어보니 다른 회사에서도 상당히 넓은 범위의 업무를 담당하고 있었다. 내가 VCNC에서 맡았던 역할은 크게 다음과 같다 :

* 프로덕트의 API 개발 - 프로덕트가 있는 회사라면 서버팀의 가장 기본적인 업무이다. 서버팀은 프로덕트 요구사항에 맞는 API를 설계하고 개발한다. 보통 엔티티 모델링과 서비스 설계를 필요로 한다.
* 데이터 팀과의 협업 - 요즘은 회사의 핵심적인 비즈니스 가치가 데이터 기반의 알고리즘에서 나오는 경우가 많다. 하지만 알고리즘이 실제적인 비즈니스 가치를 만들어내기 위해서는 결국 서버와 통합되어야 한다. 이를 위해 서버팀은 데이터 팀이 만든 외부 시스템(e.g. ML 모델 서버)을 서버와 통합하거나, 데이터 팀이 정의한 알고리즘을 서버에 직접 구현한다.
* 데이터 로깅 - 비즈니스에 대한 다양한 인사이트를 얻거나, 진행한 프로젝트가 얼마나 효과를 봤는지를 확인하기 위해서는 데이터가 필수적이다. 서버팀은 다른 팀이 활용할 수 있는 각종 데이터를 적절히 로깅한다.
* 외부 서비스 연동 - 프로덕트가 필요로 하는 몇몇 기능은 직접 구현하기 보다 요금을 지불하고 외부 서비스를 사용하는 게 더 나을 수 있다. 카드 결제, 문자, 이메일 서비스 등 도메인에 구애받지 않는 일반적인 기능이 보통 그렇다. 서버팀은 필요한 경우 외부 서비스의 API 스펙 문서를 보고 외부 서비스와의 연동을 진행한다.
* CI/CD 파이프라인 구성 - 요즘의 서버 개발에서는 지속적 통합(Continuous Integration, CI), 지속적 전달(Continuous Delivery, CD)이 거의 필수가 되었다. CI/CD가 중요한 이유는 새로운 비즈니스 가치를 빠르고 안전하게 사용자에게 전달하는 데에 큰 도움을 주기 때문이다. 서버팀은 비즈니스 가치의 빠른 전달을 위해 CI/CD 파이프라인을 구축하고 관리한다.
* 서버 운영(DevOps) - 서버에는 다양한 이유로 장애가 발생할 수 있는데, 장애로 인해 서비스가 중단되는 일을 최대한 방지해야 한다. 만일 서비스에 장애가 발생했다면 장애가 다른 곳으로 퍼지지 않게 막아야 하며, 장애로부터 빠르게 복구할 수 있어야 한다. 서버팀은 장애 방지 / 장애 전파 방지 / 빠른 장애 복구를 위한 아키텍처를 설계하고 로깅 / 모니터링 시스템, auto-scaling 시스템 등을 구축한다.
* 사내 어드민 개발 - 사내의 다양한 팀은 저마다의 니즈로 서버에 저장되어 있는 데이터를 관리하고 히스토리를 확인해야 한다. 서버팀은 다른 팀 사람들이 이용할 수 있는 사내 어드민을 개발한다.

회사가 점점 성장하면 하나의 역할에 집중한 다른 팀이 생길 수도 있다. 대표적으로 DevOps 팀, 데이터 엔지니어링 팀, 백오피스 개발 팀 등이 있다.

### 프로젝트 내에서

하나의 프로젝트에는 다양한 팀과 조직이 관여하게 되는데, 보통 PM팀, UI/UX팀, 서버팀, 클라이언트 팀, 데이터팀, QA팀, BX팀, 마케팅 팀 정도가 참여하고 운영팀이 있는 회사는 운영팀도 포함될 수 있다. 각 팀은 프로젝트에서 각자의 고유한 책임과 지고 있으며, 서버팀도 서버팀 고유의 책임과 역할이 있다. 프로젝트의 일반적인 라이프 사이클을 따라가며 서버팀의 역할을 짚어보면 다음과 같다.

- 기획 검토 및 조언 - 서버팀은 기획 단계에서 기획서를 검토하여 개발적으로 문제가 되는 부분이나 빠진 부분을 짚어준다. 더 나아가서 능동적으로 스펙을 잘라 기획을 간단하게 만들거나 기획서에 나온 목적을 달성하기 위한 다른 기술적인 방법을 제시할 수도 있다.
- 일정 산출 - 서버팀은 기획서를 검토하고 서버 개발이 어느 정도 걸릴지를 산출하여 제시한다.
- 기능 개발 및 테스트 작성 - 기획서의 요구사항을 분석하여 소프트웨어를 개발하고, 개발한 소프트웨어가 올바르게 동작하는 것을 확인하기 위한 테스트를 작성한다. 또한, 해당 프로젝트가 얼마나 성공했는지를 확인하기 위한 데이터를 로깅해야 한다.
- QA 전략 수립 - 일부 프로젝트의 경우 QA팀이 원하는 테스트 상황을 만들기 어려워서 QA를 진행하기 까다로울 수 있다. 이러한 경우 서버팀에서 최소한의 추가 개발을 통해 QA를 쉽게 할 수 있는 방법을 제시하는 게 좋을 수 있다.
- QA 대응 - 서버팀은 QA 단계에서 발견된 이슈를 해결한다.
- 배포 전략 수립 및 배포 - 서버팀은 배포를 할 때 발생할 수 있는 다양한 문제를 고려하여 배포 전략을 수립하고, 이를 이행한다. 대부분의 경우 기능 개발 단계에서부터 배포 전략을 고려해야 한다.

## 목차

아래 목차 순서는 중요도 순이 아니며, 프로젝트의 라이프 사이클을 기반으로 하여 내 임의로 결정한 순서이다.

최대한 특정 기술 스택에 관련되지 않은 내용만을 포함하려고 했으나, 일부 예외가 있다. Reactive Programming이나 모바일 클라이언트 구현 등의 내용이 대표적인데, 이 기술을 사용하지 않더라도 알고 있으면 좋은 지식이라 생각하여 포함하였다.

이미 좋은 글이 있거나 내가 이전에 작성한 글이 있어서 내가 별도로 작성할 필요가 없는 문서는 링크를 대신 걸어두었다.

* 일반론
  * 무엇을 공부해야 하는가?
  * 개발하는 코드 베이스를 아는 것이 최우선이다
  * 유용한 사고방식 및 사고 전략
  * 프로세스 바깥과 관련된 모든 것은 실패할 수 있다
* DB
  * [lock으로 이해하는 트랜잭션 isolation level](https://suhwan.dev/2019/06/09/transaction-isolation-level-and-lock/)
  * [foreign key S lock issue](http://www.chriscalender.com/advanced-innodb-deadlock-troubleshooting-what-show-innodb-status-doesnt-tell-you-and-what-diagnostics-you-should-be-looking-at/)
* 쓰레드 관리
  * multi-thread vs. event loop
  * multi-thread 사용 예시 - Spring MVC 기반 어플리케이션의 threading 전략
* Reactive Programming (Spring Reactor 기준)
  * [Spring Reactor 동작 원리 & 쓰레드 관리 (`publishOn()` vs. `subscribeOn()`)](/reactive-programming/how-spring-reactor-works.md)
  * Reactive Programming에서 일반적으로 맞닥뜨리는 까다로운 상황들
* 분산 시스템 개발
  * [분산 시스템 개발 시 고려해야 할 사항](/distributed-system/distributed-system-concerns.md)
  * [eventual consistency의 달성](/distributed-system/eventual-consistency.md)
  * 멱등성의 실제 구현 - state machine의 활용
* 다양한 개발 상황과 유의사항
  * batch job 작성 시 유의사항
  * 모바일 네이티브 클라이언트 관련 개발 시 유의사항
* 테스팅 
  * TBA
* 배포 전략
  * 상위호환성 / 하위호환성
  * feature flag
  * 배포 순서 : consumer -> producer
  * 2-step 배포
  * 배포할 때 데이터 휘발을 방지하기
* 기타 유용한 개념들
  * [캐릭터 인코딩이란?](https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/)
